{% extends 'base.html' %}
{% block content %}
  <div class="container mt-5">
    <div class="row justify-content-center">
      <div class="col-md-10">
        <div class="card border-1 rounded-2">
          <!-- Profile Header -->
          <div class="card-body text-center bg-light rounded-top-4">
            {% if profile.picture %}
              <img src="{{ profile.picture.url }}" class="rounded-circle border mb-3" width="140" height="140" style="object-fit: cover;" />
            {% else %}
              <img src="https://via.placeholder.com/140" class="rounded-circle border mb-3" />
            {% endif %}

            <h4 class="fw-bold">{{ profile.name }}</h4>
            <p class="text-muted mb-1">{{ request.user.email }}</p>
          </div>

          <!-- Profile Details -->
          <div class="card-body px-4">
            <h6 class="fw-bold">Bio</h6>
            <p class="text-muted">{{ profile.bio|default:'No bio added yet.' }}</p>
          </div>

          <!-- Footer -->
          <div class="card-footer bg-white text-center">
            <a href="{% url 'edit_profile' %}" class="btn btn-primary btn-sm px-4">Edit Profile</a>
            <a href="{% url 'posts:add_post' %}" class="btn btn-outline-primary btn-sm px-4">Add Post</a>
          </div>
        </div>
      </div>

      <div class="col-md-10 mt-3 mx-auto">
        <div class="card border-1 rounded-2">
          <div class="row g-0">
            <!-- LEFT PART -->
            <div class="col-md-6">
              <!-- Section Title -->
              <div class="card mb-3 px-2">
                <div class="card-body text-center bg-light">
                  <h4 class="mb-0">Your Posts</h4>
                </div>
              </div>

              <!-- Posts Loop -->
              {% for post in user_post %}
                <div class="card mb-4 shadow-sm px-2">
                  <!-- Card Header -->
                  <div class="card-header bg-white d-flex justify-content-between align-items-center">
                    <strong>{{ post.user.username }}</strong>

                    {% if post.user == request.user %}
                      <div>
                        <a href="{% url 'posts:edit_post' post.id %}" class="btn btn-sm btn-outline-primary">Edit</a>
                        <a href="{% url 'posts:delete_post' post.id %}" class="btn btn-sm btn-outline-danger">Delete</a>
                      </div>
                    {% endif %}
                  </div>

                  <!-- Post Image -->
                  {% if post.picture %}
                    <img src="{{ post.picture.url }}" class="card-img-top" alt="Post Image" />
                  {% endif %}

                  <!-- Card Body -->
                  <div class="card-body">
                    <p class="card-text">{{ post.caption }}</p>
                    <small class="text-muted">{{ post.created_at|date:'d M Y, h:i A' }}</small>
                  </div>
                </div>
              {% empty %}
                <div class="alert alert-info text-center">You haven't posted anything yet.</div>
              {% endfor %}
            </div>

            <!-- LIKED PART -->
            <div class="col-md-6">
              <div class="card-body text-center bg-secondary text-white">
                <h4>Liked Posts</h4>
              </div>
              {% for liked_post in user_liked_post %}
                <div class="card mb-4 shadow-sm px-2">
                  <!-- Card Header -->
                  <div class="card-header bg-white d-flex justify-content-between align-items-center">
                    <strong>{{ liked_post.post.user.username }}</strong>

                    {% comment %} {% if liked_post.user == request.user %}
                      <div>
                        <a href="{% url 'posts:edit_post' post.id %}" class="btn btn-sm btn-outline-primary">Edit</a>
                        <a href="{% url 'posts:delete_post' post.id %}" class="btn btn-sm btn-outline-danger">Delete</a>
                      </div>
                    {% endif %} {% endcomment %}
                  </div>

                  <!-- Post Image -->
                  {% if liked_post.post.picture %}
                    <img src="{{ liked_post.post.picture.url }}" class="card-img-top" alt="Post Image" />
                  {% endif %}

                  <!-- Card Body -->
                  <div class="card-body">
                    <p class="card-text">{{ liked_post.post.caption }}</p>
                    <small class="text-muted">{{ liked_post.post.created_at|date:'d M Y, h:i A' }}</small>
                  </div>
                </div>
              {% empty %}
                <div class="alert alert-info text-center">You haven't posted anything yet.</div>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock %}
